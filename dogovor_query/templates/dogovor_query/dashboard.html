{% extends 'specialist_topbar.html' %}
{% load static %}
{% block title %}
    Заявки | Договорный отдел СПбГУТ
{% endblock %}
{% block content %}
    <div class="card m-3">
        <div class="row no-gutters">
            <div class="col-2 bg-light d-flex justify-content-center align-items-center">
                <h1><span id="current_query_number">{{ query_number }}</span></h1>
            </div>
            <div class="col">
                <div class="card-body">
                    <h5 class="card-title">Текущий клиент
                        {% if status == 'activated' %}
                            <span id="span_status_text" class="badge badge-warning">Вызван</span>
                        {% elif status == 'processing' %}
                            <span id="span_status_text" class="badge badge-success">В работе</span>
                        {% else %}
                            <span id="span_status_text" class=""></span>
                        {% endif %}
                    </h5>
                    <input type="hidden" id="request_id" value="{{ request_id }}">
                    <input type="hidden" id="request_current_status" value="{{ status }}">
                    <input type="hidden" id="request_current_status_created_at" value="{{ status_created_at }}">
                    <p class="card-text">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item py-1">
                            <div class="row">
                                <div class="col-3">
                                    <span>ФИО</span>
                                </div>
                                <div class="col">
                                    <span id="current_client_fio">{{ fio }}</span>
                                </div>
                            </div>
                        </li>
                        <li class="list-group-item py-1">
                            <div class="row">
                                <div class="col-3">
                                    <span>Дата рождения</span>
                                </div>
                                <div class="col">
                                    <span id="current_client_birthday">{{ birthday }}</span>
                                </div>
                            </div>
                        </li>
                        <li class="list-group-item py-1">
                            <div class="row">
                                <div class="col-3">
                                    <span>Номер телефона</span>
                                </div>
                                <div class="col">
                                    <span id="current_client_phone_number">{{ phone_number }}</span>
                                </div>
                            </div>
                        </li>
                        <li class="list-group-item py-1">
                            <div class="row">
                                <div class="col-3">
                                    <span>Тип обращения</span>
                                </div>
                                <div class="col">
                                    <span id="current_client_request_type">{{ request_type }}</span>
                                </div>
                            </div>
                        </li>
                        <li class="list-group-item py-1">
                            <div class="row">
                                <div class="col-3">
                                    <span>Тема обращения</span>
                                </div>
                                <div class="col">
                                    <span id="current_client_request_question">{{ request_question }}</span>
                                </div>
                            </div>
                        </li>
                        <li class="list-group-item py-1">
                            <div class="row">
                                <div class="col-3">
                                    <span>Примечания</span>
                                </div>
                                <div class="col">
                                    <span id="request_notes">{{ notes }}</span>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-2 bg-light d-flex justify-content-center align-items-center">
                <h1><span id="current_client_status_time">00:00:00</span></h1>
            </div>
        </div>
    </div>
    <div class="container-fluid font-size-12">
        <table id="requests_table" class="table" cellspacing="0" width="100%">
            <thead>
            <tr>
                <th class="th-sm">ID</th>
                <th class="th-sm">Номер</th>
                <th class="th-sm">ФИО</th>
                <th class="th-sm">Дата рождения</th>
                <th class="th-sm">Номер телефона</th>
                <th class="th-sm">Тип</th>
                <th class="th-sm">Тема</th>
                <th class="th-sm">Дата создания</th>
                <th class="th-sm">Текущий статус</th>
                <th class="th-sm">Примечания</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
    <!-- Modal -->
    <div class="modal fade" id="add_note_modal" tabindex="-1" aria-labelledby="add_note_modal_label" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="add_note_modal_label">Добавить примечание к заявке</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <label for="request_note">Текст примечания</label>
                    <textarea class="form-control" id="request_text_note" rows="3"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                    <button type="button" id="add_note" class="btn btn-success">Добавить</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block additional_js %}
    {{ block.super }}
    <script type="text/javascript"
            src="https://cdn.datatables.net/v/bs4/jszip-2.5.0/dt-1.10.22/af-2.3.5/b-1.6.5/b-colvis-1.6.5/b-flash-1.6.5/b-html5-1.6.5/b-print-1.6.5/fh-3.1.7/sc-2.0.3/sl-1.3.1/datatables.min.js"></script>
    <script src="https://momentjs.com/downloads/moment.js"></script>
    <script src="{% static 'dogovor_query/perfect-scrollbar-1.4.0/dist/perfect-scrollbar.js' %}"></script>
    <script src="{% static 'dogovor_query/easytimer.min.js' %}"></script>
    <script src="{% static 'dogovor_query/toast.min.js' %}"></script>
    <script src="{% static 'dogovor_query/manager_js.js' %}"></script>
{% endblock %}
{% block additional_css %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css"
          href="https://cdn.datatables.net/v/bs4/jszip-2.5.0/dt-1.10.22/af-2.3.5/b-1.6.5/b-colvis-1.6.5/b-flash-1.6.5/b-html5-1.6.5/b-print-1.6.5/fh-3.1.7/sc-2.0.3/sl-1.3.1/datatables.min.css"/>
    <link rel="stylesheet" href="{% static 'dogovor_query/toast.min.css' %}">
    <link rel="stylesheet" href="{% static 'dogovor_query/dashboard.css' %}">
{% endblock %}